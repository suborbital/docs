<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">Vektor | Suborbital Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.suborbital.dev/docs/preview/vektor/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Vektor | Suborbital Documentation"><meta data-react-helmet="true" name="description" content="The opinionated, production-grade server framework for Go"><meta data-react-helmet="true" property="og:description" content="The opinionated, production-grade server framework for Go"><link data-react-helmet="true" rel="icon" href="/docs/preview/img/SOS_SubOrb-Icon-FullColour.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.suborbital.dev/docs/preview/vektor/"><link data-react-helmet="true" rel="alternate" href="https://docs.suborbital.dev/docs/preview/vektor/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.suborbital.dev/docs/preview/vektor/" hreflang="x-default"><link rel="stylesheet" href="/docs/preview/assets/css/styles.58ea62a6.css">
<link rel="preload" href="/docs/preview/assets/js/runtime~main.112d5c01.js" as="script">
<link rel="preload" href="/docs/preview/assets/js/main.65141cf8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/preview/"><div class="navbar__logo"><img src="/docs/preview/img/suborbital-logo-wide-trim.svg" alt="Suborbital Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/docs/preview/img/suborbital-logo-wide-trim.svg" alt="Suborbital Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><a href="https://suborbital.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Homepage<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://blog.suborbital.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/suborbital" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/preview/suborbital-ecosystem/the-suborbital-ecosystem">The Suborbital Ecosystem</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/preview/intro-to-webassembly/intro-to-wasm">Intro to WebAssembly</a><button aria-label="Toggle the collapsible sidebar category &#x27;Intro to WebAssembly&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/preview/compute/">Compute</a><button aria-label="Toggle the collapsible sidebar category &#x27;Compute&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/preview/atmo/">Atmo</a><button aria-label="Toggle the collapsible sidebar category &#x27;Atmo&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/preview/sat/">Sat</a><button aria-label="Toggle the collapsible sidebar category &#x27;Sat&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/preview/subo/">Subo</a><button aria-label="Toggle the collapsible sidebar category &#x27;Subo&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/preview/reactr/">Building Blocks</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/preview/reactr/">Reactr</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reactr&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_VCh3" aria-current="page" tabindex="0" href="/docs/preview/vektor/">Vektor</a><button aria-label="Toggle the collapsible sidebar category &#x27;Vektor&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/preview/vektor/">Testing Vektor</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/preview/grav/">Grav</a><button aria-label="Toggle the collapsible sidebar category &#x27;Grav&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/preview/contributing-guide/contributing-to-suborbital">Contributing to Suborbital</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Vektor</h1><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-opinionated-production-grade-server-framework-for-go">The opinionated, production-grade server framework for Go<a class="hash-link" href="#the-opinionated-production-grade-server-framework-for-go" title="Direct link to heading">â€‹</a></h3><p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI1LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCA5MTguOSAzMjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDkxOC45IDMyNzsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgoJLnN0MHtmaWxsOiNGRkZGRkY7fQoJLnN0MXtmaWxsOiMyMzFGMjA7fQoJLnN0MntmaWxsOiMzNTdGQkU7fQoJLnN0M3tmaWxsOiMyMjRFODQ7fQoJLnN0NHtmaWxsOiM3NEMyQjA7fQoJLnN0NXtmaWxsOiNBNkE4QUI7fQoJLnN0NntmaWxsOiM1ODU5NUI7fQoJLnN0N3tmaWxsOiM0QzYyNzU7fQoJLnN0OHtmaWxsOiMzMDNFNEU7fQo8L3N0eWxlPgo8Zz4KCTxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iMTI1LjUsMTQyIDEyNS42LDE0MiA5Ny41LDEyNS44IDk3LjUsMTI1LjggCSIvPgoJPGc+CgkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxNjkuOSw4NC4yIDE2OS45LDQ4LjggNzMuNywxMDQuMSAxMDQuNSwxMjEuOCAJCSIvPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTY5LjksMTI0LjEgNjcuMSwxODMuNyA2Ny4xLDIxOC41IDE2OS45LDE1OS40IAkJIi8+CgkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxNjkuOSwxNjcuNCAxNjkuOSwyMDIuOSAyNzIuNywxNDMuNyAyNzIuNywxMDguNCAyNzIuNywxMDguMyAJCSIvPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTY5LjksMjc4LjIgMjcyLjcsMjE5IDI3Mi43LDIxOC42IDI3Mi43LDE4My43IDI3Mi43LDE4My40IDE2OS45LDI0Mi44IAkJIi8+Cgk8L2c+Cgk8Zz4KCQk8cG9seWdvbiBjbGFzcz0ic3Q0IiBwb2ludHM9IjE2OS45LDIwMi45IDE2OS45LDE2Ny40IDEzOS4xLDE4NS4xIAkJIi8+CgkJPHBvbHlnb24gY2xhc3M9InN0NCIgcG9pbnRzPSI3My43LDIyMi44IDE2OS45LDI3OC4yIDE2OS45LDI0Mi44IDEwNC40LDIwNS4xIAkJIi8+CgkJPHBvbHlnb24gY2xhc3M9InN0NCIgcG9pbnRzPSIxMjUuNSwxNDIgOTcuNSwxMjUuOCA5Ny41LDEyNS44IDY3LjEsMTA4LjMgNjcuMSwxMDguNCA2Ny4xLDE0My4zIDY3LjEsMTQzLjcgOTQuOCwxNTkuNyAJCSIvPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDQiIHBvaW50cz0iMjY2LjEsMTA0LjEgMTY5LjksNDguOCAxNjkuOSw4NC4yIDIzNS40LDEyMS44IAkJIi8+CgkJPHBvbHlnb24gY2xhc3M9InN0NCIgcG9pbnRzPSIyMTQuNywxODUuMiAyMzUuMiwxOTcgMjY1LjksMTc5LjMgMjQ1LjQsMTY3LjUgCQkiLz4KCQk8cG9seWdvbiBjbGFzcz0ic3Q0IiBwb2ludHM9IjE2OS45LDE1OS40IDIwMC43LDE0MS44IDE2OS45LDEyNC4xIAkJIi8+Cgk8L2c+CjwvZz4KPGc+Cgk8cGF0aCBjbGFzcz0ic3Q3IiBkPSJNNDE1LjUsMTMwLjlsLTMxLDcwaC03LjNsLTMxLTcwaDhsMjYuOCw2MC44bDI3LTYwLjhINDE1LjV6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q3IiBkPSJNNDk1LjEsMTk0LjV2Ni40aC00OS41di03MGg0OHY2LjRINDUzdjI0LjloMzYuMnY2LjNINDUzdjI2SDQ5NS4xeiIvPgoJPHBhdGggY2xhc3M9InN0NyIgZD0iTTU1NC4yLDE2OGwtMTQuMywxNC41djE4LjRoLTcuNHYtNzBoNy40djQyLjNsNDEuMS00Mi4zaDguNWwtMzAuMywzMS43bDMyLjQsMzguM2gtOC44TDU1NC4yLDE2OHoiLz4KCTxwYXRoIGNsYXNzPSJzdDciIGQ9Ik02MzMuMiwxMzcuM2gtMjQuNnYtNi40aDU2LjZ2Ni40aC0yNC42djYzLjZoLTcuNFYxMzcuM3oiLz4KCTxwYXRoIGNsYXNzPSJzdDciIGQ9Ik03MDcuOCwxOTYuOGMtNS42LTMuMS0xMC03LjQtMTMuMi0xMi44Yy0zLjItNS40LTQuOC0xMS41LTQuOC0xOC4yYzAtNi43LDEuNi0xMi44LDQuOC0xOC4yCgkJYzMuMi01LjQsNy42LTkuNiwxMy4yLTEyLjhjNS42LTMuMSwxMS45LTQuNiwxOC44LTQuNmM2LjksMCwxMy4yLDEuNSwxOC44LDQuNmM1LjYsMy4xLDEwLDcuMywxMy4yLDEyLjgKCQljMy4yLDUuNCw0LjgsMTEuNSw0LjgsMTguMmMwLDYuNy0xLjYsMTIuOC00LjgsMTguMmMtMy4yLDUuNC03LjYsOS43LTEzLjIsMTIuOGMtNS42LDMuMS0xMS44LDQuNi0xOC44LDQuNgoJCUM3MTkuNywyMDEuNSw3MTMuNCwxOTkuOSw3MDcuOCwxOTYuOHogTTc0MS42LDE5MS4xYzQuNS0yLjUsOC02LDEwLjUtMTAuNGMyLjUtNC40LDMuOC05LjQsMy44LTE0LjhjMC01LjUtMS4zLTEwLjQtMy44LTE0LjgKCQljLTIuNS00LjQtNi03LjktMTAuNS0xMC40Yy00LjUtMi41LTkuNS0zLjgtMTUtMy44Yy01LjUsMC0xMC41LDEuMi0xNSwzLjhzLTgsNi0xMC42LDEwLjRzLTMuOCw5LjQtMy44LDE0LjgKCQljMCw1LjUsMS4zLDEwLjQsMy44LDE0LjhjMi42LDQuNCw2LjEsNy45LDEwLjYsMTAuNHM5LjUsMy44LDE1LDMuOEM3MzIuMSwxOTQuOSw3MzcuMSwxOTMuNiw3NDEuNiwxOTEuMXoiLz4KCTxwYXRoIGNsYXNzPSJzdDciIGQ9Ik04NDcuNywyMDAuOWwtMTYtMjIuNWMtMS44LDAuMi0zLjcsMC4zLTUuNiwwLjNoLTE4Ljh2MjIuMmgtNy40di03MGgyNi4yYzguOSwwLDE1LjksMi4xLDIxLDYuNAoJCWM1LjEsNC4zLDcuNiwxMC4xLDcuNiwxNy42YzAsNS41LTEuNCwxMC4xLTQuMiwxMy44Yy0yLjgsMy44LTYuNyw2LjUtMTEuOCw4LjJsMTcuMSwyNEg4NDcuN3ogTTg0MS44LDE2Ny44CgkJYzMuNy0zLjEsNS41LTcuNCw1LjUtMTIuOWMwLTUuNy0xLjgtMTAtNS41LTEzYy0zLjctMy05LTQuNS0xNS45LTQuNWgtMTguNnYzNS4xaDE4LjZDODMyLjgsMTcyLjQsODM4LjEsMTcwLjgsODQxLjgsMTY3Ljh6Ii8+CjwvZz4KPC9zdmc+Cg==" width="919" height="327"></p><p>Vektor&#x27;s goal is to help you develop web services faster.
Vektor handles much of the boilerplate needed to start
building a Go server, so you can serve a request in
less than 10 lines of code:</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;github.com/suborbital/vektor/vk&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">New</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">UseAppName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Vektor API Server&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">UseDomain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;vektor.example.com&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/ping&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HandlePing</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Fatal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">HandlePing</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ctx </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">interface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pong&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Those are the basics, but Vektor is capable of
scaling up to serve powerful production workloads,
using its full suite of API-oriented features.</p><h1>Set up <code>vk</code></h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-server-object">The server object<a class="hash-link" href="#the-server-object" title="Direct link to heading">â€‹</a></h2><p>The <code>vk.Server</code> type contains everything needed to
build a web service. It includes the router,
a middleware system, customizable plug-in points,
and handy built-in components like LetsEncrypt
support and CORS handlers.</p><p>Creating a server object is done with <code>vk.New()</code>
and accepts an optional list of <code>OptionModifiers</code>
which allow customization of the server:</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">server </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">New</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">UseAppName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Vektor API Server&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">UseDomain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;vektor.example.com&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>To create a server object without TLS support,
omit the <code>vk.UseDomain()</code> modifier and specify
an HTTP port to listen on.</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">server </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">New</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">UseAppName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Vektor API HTTP-only&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">UseHTTPPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">8000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The included <code>OptionsModifiers</code> are:</p><table><thead><tr><th>Option</th><th>Description</th><th>ENV key</th></tr></thead><tbody><tr><td>UseDomain(domain string)</td><td>Enable LetsEncrypt support with the provided domain name (will serve on :80 and :443 for challenge server and API server). LetsEncrypt is disabled by default.</td><td><code>VK_DOMAIN</code></td></tr><tr><td>UseTLSConfig(config *tls.Config)</td><td>Enable TLS and use the provided TLS config to serve HTTPS. This will override the <code>domain</code> option.</td><td>N/A</td></tr><tr><td>UseTLSPort(port int)</td><td>Choose an HTTPS port on which to serve requests.</td><td><code>VK_TLS_PORT</code></td></tr><tr><td>UseHTTPPort(port int)</td><td>Choose an HTTP port on which to serve requests. When using TLS, the LetsEncrypt challenge server will run on the configured HTTP port.</td><td><code>VK_HTTP_PORT</code></td></tr><tr><td>UseAppName(name string)</td><td>When the application starts, <code>name</code> will be logged. Empty by default.</td><td><code>VK_APP_NAME</code></td></tr><tr><td>UseEnvPrefix(prefix string)</td><td>Use <code>prefix</code> instead of <code>VK</code> for environment variables, for example <code>APP_HTTP_PORT</code> instead of <code>VK_HTTP_PORT</code>.</td><td>N/A</td></tr><tr><td>UseLogger(logger *vlog.Logger)</td><td>Set the logger object to be used. The logger is used internally by <code>vk</code> and is available to all handler functions via the <code>ctx</code> object. If this option is not passed, <code>vlog.Default</code> is used, and its environment variable prefix set to the same as vk&#x27;s. (<code>VK</code> by default).</td><td>N/A</td></tr></tbody></table><p>Each of the options can be set using the modifier function, or by setting the associated environment variable. The environment variable will override the modifier function.</p><blockquote><p>Note the use of <code>UseEnvPrefix</code> if you would prefer to use something other than <code>VK</code> for your environment variables!</p></blockquote><h2 class="anchor anchorWithStickyNavbar_mojV" id="handler-functions">Handler functions<a class="hash-link" href="#handler-functions" title="Direct link to heading">â€‹</a></h2><p><code>vk</code>&#x27;s handler function definition is:</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">HandlePing</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ctx </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">interface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Here&#x27;s a breakdown of each part:</p><p><code>r *http.Request</code>: The request object for the request being handled.</p><p><code>ctx *vk.Ctx</code>: A context object containing more options for
interacting with the request. See more below.</p><p><code>(interface{}, error)</code>: The return types of the handler allow you
to respond to HTTP requests by simply returning values. If an
error is returned, <code>vk</code> will interpret it as a failed request and
respond with an error code, if error is <code>nil</code>, then the <code>interface{}</code>
value is used to respond based on the response handling rules.
<strong>Responding to requests is handled in depth below in <a href="#responding-to-requests">Responding to requests</a></strong></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="mounting-routes">Mounting routes<a class="hash-link" href="#mounting-routes" title="Direct link to heading">â€‹</a></h2><p>To define routes for your <code>vk</code> server, use the HTTP method
functions on the server object:</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">server </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">New</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">UseAppName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Vektor API Server&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">UseDomain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;vektor.example.com&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/users&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HandleGetUsers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">POST</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/groups&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HandleCreateGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>If you prefer to pass the HTTP method as an argument, use <code>server.Handle()</code> instead.</p><p><strong>Note that attempting to add new handlers after calling <code>server.Start()</code> is a no-op</strong></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="route-groups">Route groups<a class="hash-link" href="#route-groups" title="Direct link to heading">â€‹</a></h2><p><code>vk</code> allows grouping routes by a common path prefix. For example, if you want a group of routes to begin with the <code>/api/</code> path, you can create an API route group and then mount all of your handlers to that group.</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apiGroup </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Group</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/api&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apiGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/events&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HandleGetEvents</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">AddGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">apiGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Calling <code>AddGroup</code> will calculate the full paths for all routes and mount them to the server. In the example above, the handler would be mounted at <code>/api/events</code>.</p><p>Groups can even be added to groups!</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">v1 </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Group</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/v1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">v1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/events&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HandleEventsV1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">v2 </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Group</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/v2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">v2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/events&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HandleEventsV2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apiGroup </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Group</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/api&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apiGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">AddGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">v1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apiGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">AddGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">v2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">AddGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">api</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will create a natural grouping of your routes,
with the above example creating the <code>/api/v1/events</code>
and <code>/api/v2/events</code> routes.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="middleware-and-afterware">Middleware and Afterware<a class="hash-link" href="#middleware-and-afterware" title="Direct link to heading">â€‹</a></h2><p>Groups become even more powerful when combined with Middleware
and Afterware. Middleware are pseudo request handlers that run
in sequence before the mounted <code>vk.HandlerFunc</code> is run.
Middleware functions can modify a request and its context,
or they can return an error, which causes the request handling
to be terminated immediately. Two examples:</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">headerMiddleware</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ctx </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">error</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Headers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;X-Vektor-Test&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;foobar&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">denyMiddleware</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ctx </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">error</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> strings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Contains</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">URL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;hack&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">ErrorString</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;HACKER!!&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">E</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">403</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;begone, hacker&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Middleware have a similar function signature to <code>vk.HandlerFunc</code>, but only return an error. The first example modifies the request context to add a response header. The second example detects a hacker and returns an error, which is handled exactly like any other error response (see below). Returning an error from a Middleware prevents the request from ever reaching the registered handler.</p><p>Middleware are applied to route groups with the <code>Before</code> method:</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">v1 </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Group</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/v1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Before</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">ContentTypeMiddleware</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;application/json&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> denyMiddleware</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> headerMiddleware</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">v1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/events&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HandleEventsV1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This example shows a group created with three middleware. The first adds the <code>Content-Type</code> response header (and is included with <code>vk</code>), the second and third are the examples from above. When the group is mounted to the server, the chain of middleware are put in place, and are run before the registered handler. When groups are nested, the middleware from the parent group are run before the middleware of any child groups. In the example of nested groups above, any middleware set on the <code>apiGroup</code> groups would run before any middleware set on the <code>v1</code> or <code>v2</code> groups.</p><p>Afterware is similar, but is run <em>after</em> the request handler. Who knew! Afterware cannot modify response body or status code, but can modify response headers using the <code>ctx</code> object. Afterware will <strong>always run</strong>, even if something earlier in the request chain fails. Here&#x27;s an example:</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">logAfter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ctx </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Info</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;request completed&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">v2 </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Group</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/v2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Before</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">ContentTypeMiddleware</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;application/json&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">After</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">logAfter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">v2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/events&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HandleEventsV2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Middleware and Afterware in <code>vk</code> is designed to be easily composable, creating chains of behaviour easily grouped to sets of routes. Middleware can also help increase security of applications, allowing authentication, request throttling, active defence, etc, to run before the registered handler and keeping sensitive code from even being reached in the case of an unauthorized request.</p><h1>Responding to requests</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="response-types">Response types<a class="hash-link" href="#response-types" title="Direct link to heading">â€‹</a></h2><p><code>vk</code> includes two types, <code>Response</code> and <code>Error</code>
(with helper functions <code>vk.Respond(...)</code> and
<code>vk.Err(...)</code>) that can be used to gain extra
control over the response code and contents
that you want to return:</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> createdResponse </span><span class="token keyword" style="font-style:italic">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Name </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">`json:&quot;name&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    UUID </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">`json:&quot;uuid&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">HandleCreate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ctx </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">interface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Do some work</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    resp </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> createdResponse </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Wendy&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        UUID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jfioqerjhp98qergnjw98h23&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Return 201 (Created) and JSON</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Respond</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StatusCreated</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> resp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">HandleDelete</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ctx </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">interface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Oops, something went wrong</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">nil</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> vk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Err</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StatusConflict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;the user is already deleted&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// responds with HTTP status 409 and body {&quot;status&quot;: 409, &quot;message&quot;: &quot;the user is already deleted&quot;}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><code>vk.Respond</code> and <code>vk.Err</code> can be used with their shortcuts
<code>vk.R</code> and <code>vk.E</code> if you like your code to be terse.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="response-handling-rules">Response handling rules<a class="hash-link" href="#response-handling-rules" title="Direct link to heading">â€‹</a></h2><p><code>vk</code> processes the <code>(interface{}, error)</code> returned by handler functions in a spcific way to ensure you always know how it will behave while still being able to use simple types in your code.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="successful-responses-ie-the-interface-returned-by-handler-functions">Successful responses (i.e. the <code>interface{}</code> returned by handler functions):<a class="hash-link" href="#successful-responses-ie-the-interface-returned-by-handler-functions" title="Direct link to heading">â€‹</a></h3><p><code>vk.Response</code> is an (optional) type that can be used to control the behaviour of the response, if desired. <code>vk.Respond(...)</code> returns a <code>vk.Response</code>.</p><ol><li>If the type is <code>vk.Response</code>, set the HTTP status code provided and process <code>Response.body</code> as follows. (If the type is NOT <code>vk.Response</code>, the status code is set to <code>200 OK</code>)</li><li>If the type is string, write the string (as UTF-8 bytes) to the response body.</li><li>If the type is bytes, write them directly to the response body.</li><li>If the type is a struct, attempt to marshal to JSON and write JSON bytes to the response body.</li></ol><p>If a Content-Type is not explicitly set by your code in the middleware chain or <code>HandlerFunc</code>, the value will be inferred from the type returned from the <code>HandlerFunc</code>.</p><p>Examples:</p><table><thead><tr><th>Handler returns...</th><th>Status Code</th><th>Response body</th><th>Content-Type</th></tr></thead><tbody><tr><td><code>return &quot;Hello, World&quot;, nil</code></td><td>200 OK</td><td>&quot;Hello World&quot; (as UTF-8 bytes)</td><td><code>text/plain</code></td></tr><tr><td><code>return jsonBytesFromJSONMarshal, nil</code></td><td>200 OK</td><td>[JSON bytes as generated by json.Marshal]</td><td><code>application/octet-stream</code></td></tr><tr><td><code>return someStructInstance, nil</code></td><td>200 OK</td><td>[JSON respresentation of struct automatically marshalled by <code>vk</code>]</td><td><code>application/json</code></td></tr><tr><td><code>return vk.R(http.StatusCreated, &quot;created&quot;), nil</code></td><td>201 Created</td><td>&quot;created&quot; (as UTF-8 bytes)</td><td><code>text/plain</code></td></tr><tr><td><code>return vk.R(http.StatusCreated, someStructInstance), nil</code></td><td>201 Created</td><td>[JSON respresentation of struct automatically marshalled by <code>vk</code>]</td><td><code>application/json</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="failure-responses-ie-the-error-returned-by-middleware-or-handler-functions">Failure responses (i.e. the <code>error</code> returned by middleware or handler functions):<a class="hash-link" href="#failure-responses-ie-the-error-returned-by-middleware-or-handler-functions" title="Direct link to heading">â€‹</a></h3><p><code>vk.Error</code> is an interface that can be used to control the behaviour of error responses. <code>vk.ErrorResponse</code> is a concrete type that implements <code>vk.Error</code>. Any errors that do NOT implement <code>vk.Error</code> will be treated as potentially unsafe, and their contents will be logged but not returned to the caller. Use <code>vk.Wrap(...)</code> if you&#x27;d like to wrap an <code>error</code> in <code>vk.ErrorResponse</code>. <code>vk.Err</code> returns a <code>vk.Error</code>.</p><p><code>vk.Error</code> looks like this:</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> Error </span><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// this ensures all Errors will also conform to the normal error interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">Message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">Status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Errors returned from middleware or <code>HandlerFunc</code>s are
handled as follows:</p><ol><li><p>If the type is <code>vk.Error</code>, set the HTTP status code
provided and respond with JSON as follows: <code>{&quot;status&quot;: err.Status(), &quot;message&quot;: err.Message()}</code></p></li><li><p>If the type is NOT <code>vk.Error</code>, log the potentially
unsafe error contents, set the HTTP status code to 500,
and respond with &quot;Internal Server Error&quot;</p></li></ol><p>Examples:</p><table><thead><tr><th>Handler returns...</th><th>Status Code</th><th>Response body</th><th>Content-Type</th></tr></thead><tbody><tr><td><code>return nil, errors.New(&quot;failed to add user&quot;)</code></td><td>500 Internal Server Error</td><td>&quot;Internal Server Error&quot; (as UTF-8 bytes)</td><td><code>text/plain</code></td></tr><tr><td><code>return nil, vk.E(http.StatusForbidden, &quot;not permitted to do this thing&quot;)</code></td><td>403 Forbidden</td><td><code>{&quot;status&quot;: 403, &quot;message&quot;: &quot;not permitted to do this thing&quot;}</code></td><td><code>application/json</code></td></tr><tr><td><code>return nil, vk.Wrap(http.StatusApplicationError, err)</code></td><td>434 Application Error</td><td><code>{&quot;status&quot;: 434, &quot;message&quot;: err.Error()}</code></td><td><code>application/json</code></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="standard-httphandlerfunc">Standard http.HandlerFunc<a class="hash-link" href="#standard-httphandlerfunc" title="Direct link to heading">â€‹</a></h2><p><code>vk</code> can use standard <code>http.HandlerFunc</code> handlers
by mounting them with <code>server.HandleHTTP</code>. This
is useful for mounting handler functions provided
by third party libraries (such as Prometheus),
but they are not able to take advantage of many <code>vk</code>
features such as middleware or route groups currently.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-ctx-object">The Ctx Object<a class="hash-link" href="#the-ctx-object" title="Direct link to heading">â€‹</a></h2><p>Each request handler is passed a <code>vk.Ctx</code> object,
which is a context object for the request. It is
similar to the <code>context.Context</code> type (and uses
one under the hood), but <code>Ctx</code> has been augmented
for use in web service development.</p><p><code>Ctx</code> includes a standard Go <code>context.Context</code>
which can be used as a pseudo key/value store using
<code>ctx.Set()</code> and <code>ctx.Get()</code>. This allows passing
things into request handlers such as database
connections or other persistent objects. Middleware
and Afterware can access the <code>Ctx</code> to modify it,
or access data from it.</p><p>The server&#x27;s configured <code>vlog.Logger</code> object is
included (<code>ctx.Log</code>) for logging within request
handlers, and a shortcut for setting the logger&#x27;s
scope for the current request exists with
<code>ctx.UseScope(...)</code>. You can learn about scope
in <a href="/docs/preview/vlog/README.md">the vlog docs</a>. A default
scope will always be set with the request ID included.</p><p>Accessing the URL params for the request
(such as <code>/users/:uuid</code>) is done with <code>ctx.Params</code>,
and <code>ctx.RespHeaders</code> can be used to set response headers
if needed.</p><p><code>Ctx</code> can also be used to easily get a request ID,
with <code>ctx.RequestID()</code>. The Request ID is generated
and cached on the object, and so calling it multiple
times will return the same value. If you prefer to
set your own Request ID, <code>ctx.UseRequestID()</code> will do
the trick. However it will mean the first log message
for the request will have a different ID as it uses
the default ID generated for the <code>ctx</code>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/suborbital/docs/edit/main/website/docs/vektor/vektor.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-02-28T21:03:52.000Z">2/28/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/preview/vektor/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Vektor</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-opinionated-production-grade-server-framework-for-go" class="table-of-contents__link toc-highlight">The opinionated, production-grade server framework for Go</a></li><li><a href="#the-server-object" class="table-of-contents__link toc-highlight">The server object</a></li><li><a href="#handler-functions" class="table-of-contents__link toc-highlight">Handler functions</a></li><li><a href="#mounting-routes" class="table-of-contents__link toc-highlight">Mounting routes</a></li><li><a href="#route-groups" class="table-of-contents__link toc-highlight">Route groups</a></li><li><a href="#middleware-and-afterware" class="table-of-contents__link toc-highlight">Middleware and Afterware</a></li><li><a href="#response-types" class="table-of-contents__link toc-highlight">Response types</a></li><li><a href="#response-handling-rules" class="table-of-contents__link toc-highlight">Response handling rules</a><ul><li><a href="#successful-responses-ie-the-interface-returned-by-handler-functions" class="table-of-contents__link toc-highlight">Successful responses (i.e. the <code>interface{}</code> returned by handler functions):</a></li><li><a href="#failure-responses-ie-the-error-returned-by-middleware-or-handler-functions" class="table-of-contents__link toc-highlight">Failure responses (i.e. the <code>error</code> returned by middleware or handler functions):</a></li></ul></li><li><a href="#standard-httphandlerfunc" class="table-of-contents__link toc-highlight">Standard http.HandlerFunc</a></li><li><a href="#the-ctx-object" class="table-of-contents__link toc-highlight">The Ctx Object</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://chat.suborbital.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/suborbital" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/SuborbitalDev" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items"><li class="footer__item"><a href="https://blog.suborbital.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://suborbital.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Suborbital Contributors. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs/preview/assets/js/runtime~main.112d5c01.js"></script>
<script src="/docs/preview/assets/js/main.65141cf8.js"></script>
</body>
</html>
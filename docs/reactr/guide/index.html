<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Get started with Reactr üöÄ | Suborbital Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.suborbital.dev/docs/reactr/guide"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Get started with Reactr üöÄ | Suborbital Documentation"><meta data-react-helmet="true" name="description" content="Once you&#x27;ve gotten the basics of Reactr, follow along here to learn what makes it so powerful."><meta data-react-helmet="true" property="og:description" content="Once you&#x27;ve gotten the basics of Reactr, follow along here to learn what makes it so powerful."><link data-react-helmet="true" rel="icon" href="/img/SOS_SubOrb-Icon-FullColour.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.suborbital.dev/docs/reactr/guide"><link data-react-helmet="true" rel="alternate" href="https://docs.suborbital.dev/docs/reactr/guide" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.suborbital.dev/docs/reactr/guide" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.fa8e9b05.css">
<link rel="preload" href="/assets/js/runtime~main.4e2ba471.js" as="script">
<link rel="preload" href="/assets/js/main.5234295a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/SOS_Alt-Long-FullColour.svg" alt="Suborbital Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/SOS_Alt-Long-FullColour.svg" alt="Suborbital Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a><a href="https://suborbital.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Homepage<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://blog.suborbital.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/suborbital" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/suborbital-ecosystem/the-suborbital-ecosystem">The Suborbital Ecosystem</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro-to-webassembly/history">Intro to WebAssembly</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/compute/what-is-compute">Compute</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/atmo/getstarted/what-is-atmo">Atmo</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/grav/what-is-grav">Building Blocks</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/grav/what-is-grav">Grav</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/docs/reactr/guide">Reactr</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/docs/reactr/guide">Start Here</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/reactr/guide">Get started with Reactr üöÄ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/reactr/wasm">Reactr and WASM</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/reactr/grav">Reactr and GRAV</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/reactr/faas">Reactr and FaaS</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/vektor/getting-started">Vektor</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/contributing-guide/contributing-to-suborbital">Contributing to Suborbital</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Get started with Reactr üöÄ</h1></header><p>Once you&#x27;ve gotten the basics of Reactr, follow along here to learn what makes it so powerful.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="runnables-pt-2">Runnables pt. 2<a class="hash-link" href="#runnables-pt-2" title="Direct link to heading">‚Äã</a></h2><p>There are some more complicated things you can do with Runnables:</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">type recursive struct{}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Run runs a recursive job</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">func (r recursive) Run(job rt.Job, ctx *rt.Ctx) (interface{}, error) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fmt.Println(&quot;doing job:&quot;, job.String())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if job.String() == &quot;first&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return ctx.Do(rt.NewJob(&quot;recursive&quot;, &quot;second&quot;)), nil</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } else if job.String() == &quot;second&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return ctx.Do(rt.NewJob(&quot;recursive&quot;, &quot;last&quot;)), nil</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return fmt.Sprintf(&quot;finished %s&quot;, job.String()), nil</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">func (r recursive) OnChange(change rt.ChangeEvent) error {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return nil</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>rt.Ctx</code> you see there is the job context, and one of the things it can do is run more things!</p><p>Calling <code>ctx.Do</code> will schedule another job to be executed and give you a <code>Result</code>. If you return a <code>Result</code> from <code>Run</code>, then the caller will recursively recieve that <code>Result</code> when they call <code>Then()</code>!</p><p>For example:</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">r := r.Do(r.Job(&quot;recursive&quot;, &quot;first&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">res, err := r.Then()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if err != nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log.Fatal(err)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">fmt.Println(&quot;done!&quot;, res.(string))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Will cause this output:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">doing job: first</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doing job: second</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doing job: last</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">done! finished last</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The ability to chain jobs is quite powerful!</p><p>You won&#x27;t always need or care about a job&#x27;s output, and in those cases, make sure to call <code>Discard()</code> on the result to allow the underlying resources to be deallocated!</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">r.Do(r.Job(&quot;recursive&quot;, &quot;first&quot;)).Discard()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To do something asynchronously with the <code>Result</code> once it completes, call <code>ThenDo</code> on the result:</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">r.Do(r.Job(&quot;generic&quot;, &quot;first&quot;)).ThenDo(func(res interface{}, err error) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if err != nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // do something with the error</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    //do something with the result</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>ThenDo</code> will return immediately, and provided callback will be run on a background goroutine. This is useful for handling results that don&#x27;t need to be consumed by your main program execution.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="groups">Groups<a class="hash-link" href="#groups" title="Direct link to heading">‚Äã</a></h3><p>A reactr <code>Group</code> is a set of <code>Result</code>s that belong together. If you&#x27;re familiar with Go&#x27;s <code>errgroup.Group{}</code>, it is similar. Adding results to a group will allow you to evaluate them all together at a later time.</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grp := rt.NewGroup()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grp.Add(ctx.Do(rt.NewJob(&quot;recursive&quot;, &quot;first&quot;)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grp.Add(ctx.Do(rt.NewJob(&quot;generic&quot;, &quot;group work&quot;)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grp.Add(ctx.Do(rt.NewJob(&quot;generic&quot;, &quot;group work&quot;)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if err := grp.Wait(); err != nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log.Fatal(err)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Will print: </p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">doing job: first</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doing job: group work</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doing job: group work</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doing job: second</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doing job: last</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>As you can see, the &quot;recursive&quot; jobs from the <code>generic</code> runner get queued up after the two jobs that don&#x27;t recurse.</p><p>Note that you cannot get result values from result groups, the error returned from <code>Wait()</code> will be the first error from any of the results in the group, if any. To get result values from a group of jobs, put them in an array and call <code>Then</code> on them individually.</p><p><strong>TIP</strong> If you return a group from a Runnable&#x27;s <code>Run</code>, calling <code>Then()</code> on the result will recursively call <code>Wait()</code> on the group and return the error to the original caller! You can easily chain jobs and job groups in various orders.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="pools">Pools<a class="hash-link" href="#pools" title="Direct link to heading">‚Äã</a></h3><p>Each <code>Runnable</code> that you register is given a worker to process their jobs. By default, each worker has one work thread processing jobs in sequence. If you want a particular worker to process more than one job concurrently, you can increase its <code>PoolSize</code>:</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">doGeneric := r.Register(&quot;generic&quot;, generic{}, rt.PoolSize(3))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grp := rt.NewGroup()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grp.Add(doGeneric(&quot;first&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grp.Add(doGeneric(&quot;second&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grp.Add(doGeneric(&quot;random&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if err := grp.Wait(); err != nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log.Fatal(err)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Passing <code>PoolSize(3)</code> will spawn three work threads to process <code>generic</code> jobs.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="autoscaling-pools">Autoscaling pools<a class="hash-link" href="#autoscaling-pools" title="Direct link to heading">‚Äã</a></h3><p>By default, defining a pool size causes a static number of work threads to be started and will continue to run for the duration of the program&#x27;s lifetime. If you have more variable workloads and need to scale your compute up and down to compensate, Reactr can handle that with the Autoscale option:</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">doGeneric := r.Register(&quot;generic&quot;, generic{}, rt.Autoscale(0))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for i := 0; i &lt; 10000; i++ {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    doGeneric(&quot;lots to do&quot;).Discard()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>By passing the <code>rt.Autoscale</code> option, we indicate to Reactr that the worker should create and destroy threads as needed to handle the amount of work to be done. The parameter passed to Autoscale indicates the maximum number of threads. If you pass 0, it will default to the number of available CPUs.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="timeouts">Timeouts<a class="hash-link" href="#timeouts" title="Direct link to heading">‚Äã</a></h3><p>By default, if a job becomes stuck and is blocking execution, it will block forever. If you want to have a worker time out after a certain amount of seconds on a stuck job, pass <code>rt.TimeoutSeconds</code> to Handle:</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">h := rt.New()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doTimeout := r.Register(&quot;timeout&quot;, timeoutRunner{}, rt.TimeoutSeconds(3))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>When <code>TimeoutSeconds</code> is set and a job executes for longer than the provided number of seconds, the worker will move on to the next job and <code>ErrJobTimeout</code> will be returned to the Result. The failed job will continue to execute in the background, but its result will be discarded.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="schedules">Schedules<a class="hash-link" href="#schedules" title="Direct link to heading">‚Äã</a></h3><p>The <code>r.Do</code> method will run your job immediately, but if you need to run a job at a later time, at a regular interval, or on some other schedule, then the <code>Schedule</code> interface will help. The <code>Schedule</code> interface allows for an object to choose when to execute a job. Any object that conforms to the interface can be used as a Schedule:</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Schedule is a type that returns an *optional* job if there is something that should be scheduled.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Reactr will poll the Check() method at regular intervals to see if work is available.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type Schedule interface {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Check() *Job</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Done() bool</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>r.Schedule</code> method will allow you to register a Schedule, and there are two built-in schedules(<code>Every</code> and <code>After</code>) to help:</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">r := rt.New()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">r.Register(&quot;worker&quot;, &amp;workerRunner{})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// runs every hour</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">r.Schedule(rt.Every(60*60, func() Job {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return NewJob(&quot;worker&quot;, nil)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Reactr will poll all registered Schedules at a 1 second interval to <code>Check</code> for new jobs. Schedules can end their own execution by returning <code>false</code> from the <code>Done</code> method. You can use the Schedules provided with Reactr or develop your own.</p><p>Scheduled jobs&#x27; results are discarded automatically using <code>Discard()</code></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="advanced-runnables">Advanced Runnables<a class="hash-link" href="#advanced-runnables" title="Direct link to heading">‚Äã</a></h3><p>The <code>Runnable</code> interface defines an <code>OnChange</code> function which gives the Runnable a chance to prepare itself for changes to the worker running it. For example, when a Runnable is registered with a pool size greater than 1, the Runnable may need to provision resources for itself to enable handling jobs concurrently, and <code>OnChange</code> will be called once each time a new worker starts up. Our <a href="https://github.com/suborbital/reactr/blob/master/rwasm/wasmrunnable.go" target="_blank" rel="noopener noreferrer">Wasm implementation</a> is a good example of this. </p><p>Most Runnables can return <code>nil</code> from this function, however returning an error will cause the worker start to be paused and retried until the required pool size has been acheived. The number of seconds between retries (default 3) and the maximum number of retries (default 5) can be configured when registering a Runnable:</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">doBad := r.Register(&quot;badRunner&quot;, badRunner{}, rt.RetrySeconds(1), rt.MaxRetries(10))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Any error from a failed worker will be returned to the first job that is attempted for that Runnable.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="pre-warming">Pre-warming<a class="hash-link" href="#pre-warming" title="Direct link to heading">‚Äã</a></h3><p>When a Runnable is mounted, it is simply registered as available to receive work. The Runnable is not actually invoked until the first job of the given type is received. For basic Runnables, this is normally fine, but for Runnables who use the <code>OnChange</code> method to provision resources, this can cause the first job to be slow. The <code>PreWarm</code> option is available to allow Runnables to be started as soon as they are mounted, rather than waiting for the first job. This mitigates cold-starts when anything expensive is needed at startup.</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">doExpensive := r.Register(&quot;expensive&quot;, expensiveRunnable{}, rt.PreWarm())</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="shortcuts">Shortcuts<a class="hash-link" href="#shortcuts" title="Direct link to heading">‚Äã</a></h3><p>There are also some shortcuts to make working with Reactr a bit easier:</p><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">type input struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    First, Second int</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type math struct{}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Run runs a math job</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">func (g math) Run(job rt.Job, ctx *rt.Ctx) (interface{}, error) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    in := job.Data().(input)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return in.First + in.Second, nil</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">doMath := r.Register(&quot;math&quot;, math{})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for i := 1; i &lt; 10; i++ {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    equals, _ := doMath(input{i, i * 3}).ThenInt()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fmt.Println(&quot;result&quot;, equals)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>Register</code> function returns an optional helper function. Instead of passing a job name and full <code>Job</code> into <code>r.Do</code>, you can use the helper function to instead just pass the input data for the job, and you receive a <code>Result</code> as normal. <code>doMath</code>!</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="additional-features">Additional features<a class="hash-link" href="#additional-features" title="Direct link to heading">‚Äã</a></h2><p>Reactr can integrate with <a href="https://github.com/suborbital/grav" target="_blank" rel="noopener noreferrer">Grav</a>, which is the decentralized message bus developed as part of the Suborbital Development Platform. Read about the integration on <a href="/docs/reactr/grav">the grav documentation page.</a></p><p>Reactr provides the building blocks for scalable asynchronous systems. This should be everything you need to help you improve the performance of your application. When you are looking to take advantage of Reactr&#x27;s other features, check out its <a href="/docs/reactr/faas">FaaS</a> and <a href="/docs/reactr/wasm">Wasm</a> capabilities!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/suborbital/docs/docs/reactr/guide.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-01-22T18:41:13.000Z">1/22/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/grav/networking/discovery/local-network-discovery"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Local Network Discovery</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/reactr/wasm"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Reactr ‚ù§Ô∏è WebAssembly</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#runnables-pt-2" class="table-of-contents__link toc-highlight">Runnables pt. 2</a><ul><li><a href="#groups" class="table-of-contents__link toc-highlight">Groups</a></li><li><a href="#pools" class="table-of-contents__link toc-highlight">Pools</a></li><li><a href="#autoscaling-pools" class="table-of-contents__link toc-highlight">Autoscaling pools</a></li><li><a href="#timeouts" class="table-of-contents__link toc-highlight">Timeouts</a></li><li><a href="#schedules" class="table-of-contents__link toc-highlight">Schedules</a></li><li><a href="#advanced-runnables" class="table-of-contents__link toc-highlight">Advanced Runnables</a></li><li><a href="#pre-warming" class="table-of-contents__link toc-highlight">Pre-warming</a></li><li><a href="#shortcuts" class="table-of-contents__link toc-highlight">Shortcuts</a></li></ul></li><li><a href="#additional-features" class="table-of-contents__link toc-highlight">Additional features</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://chat.suborbital.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/suborbital" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/SuborbitalDev" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items"><li class="footer__item"><a href="https://blog.suborbital.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://suborbital.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 Suborbital Contributors. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4e2ba471.js"></script>
<script src="/assets/js/main.5234295a.js"></script>
</body>
</html>